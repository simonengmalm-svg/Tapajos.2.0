<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>TAPAJOS – Det roliga fastighetsbolaget</title>
  <link rel="stylesheet" href="style.css"/>
  <style>
    html,body{margin:0;background:#0b1a44;color:#fff;font-family:system-ui,Segoe UI,Arial}
    .splash{min-height:100vh;display:flex;flex-direction:column;align-items:center;gap:14px;padding:32px 16px}
    .title{font-size:clamp(22px,3vw,36px);font-weight:800;text-align:center;margin-top:6px}
    .sub{opacity:.9}
    .form{display:grid;gap:10px;max-width:420px;width:100%}
    input{padding:12px;border-radius:10px;border:2px solid #000;background:#0f1524;color:#fff}
    .row{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
    button{padding:10px 18px;border-radius:10px;cursor:pointer}
    #startBtn{background:#ffd500;border:none;font-weight:700;color:#111}
    #openHS{background:transparent;border:2px solid #fff;color:#fff}
    /* säker max-z-index så inget ligger ovanpå */
    #startBtn{position:relative;z-index:9999}
  </style>
</head>
<body>

  <!-- Splash -->
  <div class="splash" id="splash">
    <img src="assets/mascot.png" alt="Maskot" style="max-width:180px"/>
    <div class="title">TAPAJOS – Det roliga fastighetsbolaget</div>
    <div class="sub">Bygg, förvalta och gör vinst på 15 år</div>
    <p style="max-width:800px;text-align:center;opacity:.9">
      Exploiten är stängd. Systemet har anpassats.
      Version 1.1 är inte längre ett lätt byte – klarar du dig i den nya spelplanen?
    </p>

    <div class="form">
      <label style="display:grid;gap:6px">
        <span>Namn</span>
        <input id="startName" placeholder="Ditt namn" autocomplete="name"/>
      </label>
      <label style="display:grid;gap:6px">
        <span>Företag</span>
        <input id="startCompany" placeholder="Företag (valfritt)" autocomplete="organization"/>
      </label>
      <label style="display:flex;gap:8px;align-items:center">
        <input id="rememberProfile" type="checkbox" checked/>
        <span>Kom ihåg mig på den här enheten</span>
      </label>
    </div>

    <div class="row">
      <!-- inline onclick + fallback = alltid start -->
      <button id="startBtn" type="button"
        onclick="(window.startGame||function(){
          document.getElementById('splash').style.display='none';
          document.getElementById('appWrap').style.display='block';
          console.warn('[fallback] startGame saknas – visade appen ändå');
        })()">
        Starta spelet
      </button>
      <button id="openHS" type="button" onclick="window.openHSModal?.()">Highscore 🏆</button>
    </div>
  </div>

  <!-- App -->
  <div id="appWrap" style="display:none;padding:20px">
    <div class="topbar" style="display:flex;gap:16px;align-items:center;flex-wrap:wrap">
      <img src="assets/mascot.png" alt="" style="width:40px;height:40px;border-radius:8px"/>
      <div style="font-weight:700">Spelet körs</div>
      <div>💰 Kassa: <span id="cash">10 000 000</span> kr</div>
      <div>💳 Skuld: <span id="debtTop">0</span> kr</div>
      <div>📅 År: <span id="yearNow">1</span> / 15</div>
      <div>📈 Marknad: <span id="market">1.00×</span></div>
      <div>🏦 Ränta: <span id="rate">3.0</span>%</div>
    </div>

    <h3 style="margin-top:18px">Mina fastigheter</h3>
    <div id="props" style="min-height:120px;background:#0f1b3a;border-radius:12px;padding:12px"></div>
  </div>

  <!-- Modul med startGame -->
  <script type="module" src="./src/game.js"></script>

  <!-- Universal nödbindning i capturing, ifall något ändå blockerar -->
  <script>
    document.addEventListener('click', function(e){
      const b = e.target.closest?.('#startBtn');
      if(!b) return;
      try{
        if(typeof window.startGame==='function'){ e.preventDefault(); window.startGame(); }
      }catch(err){ console.warn('startGame fel:', err); }
    }, true);
  </script>
</body>
</html>
